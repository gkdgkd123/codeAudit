# ZZCMS 2023 SQL注入漏洞user/adv2.php

## CVE-ID

CVE-2024-44817

## Vulnerability type 

Insecure Permissions 

## Vendor of the product(s) 

http://www.zzcms.net/about/download.html

## Affected product(s)/code base 

## Product	* Version	

ZZCMS
<=2023(latest)



## Optional

Has vendor confirmed or acknowledged the vulnerability? No

## Attack type info 

Remote

Other : With administrator rights, attacker can delete any file.

## Affected component(s)

```
File: user/adv2.php
Line: 69
Vulnerable Code:
$rs = query("select * from zzcms_ad where id=" . $_POST["id"] . "");
```



## Attack vector(s)

```
We can exploit this vulnerability by sending a specially crafted POST request with a payload such as:

POST action=modify&id=0 UNION SELECT 1,2,3,4,5,6,7,8,9,0,1,user(),3,4,5,6 #

This payload allows the attacker to execute arbitrary SQL commands, potentially leading to unauthorized data access, data manipulation, or other malicious actions within the database.
```



## Suggested description of the vulnerability for use in the CVE 

```
A SQL injection vulnerability exists in the user/adv2.php file of the affected application, specifically at line 69. The vulnerable code constructs a SQL query using user-supplied input without proper sanitization or parameterization. This allows an attacker to manipulate the SQL query by injecting arbitrary SQL code through the id parameter in a POST request.
```



## Discoverer(s)/Credits info

GKDf1sh



## Reference(s) info

```
http://demo.zzcms.net
```



## Additional information

```PHP

```

